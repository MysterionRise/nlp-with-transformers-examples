import datetime

import torch
import torch.nn.functional as F
from transformers import AutoModel, AutoTokenizer


def mean_pooling(model_output, attention_mask):
    token_embeddings = model_output[0]
    input_mask_expanded = (
        attention_mask.unsqueeze(-1).expand(token_embeddings.size()).float()
    )
    return torch.sum(token_embeddings * input_mask_expanded, 1) / torch.clamp(
        input_mask_expanded.sum(1), min=1e-9
    )


sentences = [
    "We examine the comparative thermal evolution of Jupiter and Saturn, applying recent theoretical results for helium’s immiscibility in fluid metallic hydrogen. The redistribution of helium in their interiors proceeds very differently for the two planets. We confirm that, based on Jupiter’s atmospheric helium depletion as observed in situ by the <i>Galileo</i> entry probe, Jupiter’s interior helium has differentiated modestly, and we present models reconciling Jupiter’s helium depletion, radius, and heat flow at the solar age. Jupiter’s recently revised Bond albedo implies a higher intrinsic flux for the planet, accommodating more luminosity from helium differentiation, such that mildly superadiabatic interiors can satisfy all constraints. The same phase diagram applied to the less massive Saturn predicts dramatic helium differentiation, to the degree that Saturn inevitably forms a helium-rich shell or core, an outcome previously proposed by Stevenson &amp; Salpeter and others. The luminosity from Saturn’s helium differentiation is sufficient to extend its cooling time to the solar age, even for adiabatic interiors. This model predicts Saturn’s atmospheric helium to be depleted to <i>Y</i> = 0.07 ± 0.01, corresponding to a He/H<sub>2</sub> mixing ratio 0.036 ± 0.006. We also show that neon differentiation may have contributed to both planets’ luminosity in the past. These results demonstrate that Jupiter and Saturn’s thermal evolution can be explained self-consistently with a single physical model, and emphasize that nontrivial helium distributions should be considered in future models for Saturn’s internal structure and dynamo.",
    "82 single-lined hot subdwarf stars are identified by using spectra from the sixth and seventh data releases (DR6 and DR7) of the Large Sky Area Multi-Object Fibre Spectroscopic Telescope survey. We classified all the hot subdwarf stars using a canonical classification scheme, and got 89 sdB, 37 sdOB, 26 sdO, 24 He-sdOB, 3 He-sdO, and 3 He-sdB stars, respectively. Among these stars, 108 hot subdwarfs are newly discovered, while 74 stars were reported by previous catalogs. The atmospheric parameters of these stars were obtained by fitting the hydrogen (H) and helium (He) lines with non-local thermodynamic equilibrium model atmospheres. The atmospheric parameters confirm the two He sequences and the two subgroups of He-sdOB stars in our samples, which were found by previous studies in the <i>T</i> <sub>eff</sub>–\(\mathrm{log}(n\mathrm{He}/n{\rm{H}})\) diagram. Our results demonstrate different origins of field hot subdwarf stars and extreme horizontal branch stars in globular clusters, and provide strict observational limits on the formation and evolution models of the different sub-types of these evolved objects. Based on the results, we evaluated the completeness of the Geier et al. catalog. We found the fraction of hot subwarf stars is between 10% and 60%, depending on the brightness of the sample. A more accurate estimation for the hot subdwarf fraction can be obtained when similar results from composite spectra will become available.",
    "Streams are major sources of carbon dioxide (CO2) and methane (CH4) to the atmosphere, but current large-scale estimates are associated with high uncertainties because knowledge concerning the spatiotemporal control on stream emissions is limited. One of the largest uncertainties derives from the choice of gas transfer velocity (k600), which describes the physical efficiency of gas exchange across the water-atmosphere interface. This study therefore explored the variability in k600 and subsequent CO2 and CH4 emission rates within and across streams of different stream order (SO). We conducted, for the first time in streams, direct turbulence measurements using an acoustic Doppler velocimeter (ADV) to determine the spatial variability in k600 across a variety of scales with a consistent methodology. The results show high spatial variability in k600 and corresponding CO2 and CH4 emissions at small spatial scales, both within stream reaches and across SO, especially during high discharge. The k600 was positively related to current velocity and Reynolds number. By contrast, no clear relationship was found between k600 and specific stream characteristics such as width and depth, which are parameters often used in empirical models of k600. Improved understanding of the small-scale variability in the physical properties along streams, especially during high discharge, is therefore an important step to reduce the uncertainty in existing gas transfer models and emissions for stream systems. The ADV method was a useful tool for revealing spatial variability in this work, but it needs further development. We recommend that future studies conduct measurements over shorter time periods (e.g., 10-15 min instead of 40 min) and at more sites across the reach of interest, and thereby derive more reliable mean-reach k600 as well as more information about controls on the spatial variability in k600.",
    "Antarctic krill (Euphausia superba) is one of the most successful species on Earth and serves as the largest potential protein bank for both Antarctic animals and humans. Research on this species is of great value for exploitation of Antarctic biotic resources. In this study, the metabolomics of E. superba were investigated using the GC-MS method. A total of 293 compounds were initially identified; these compounds could be divided into several classes, including amino acids, sugars and polyols, metabolic intermediates, small molecules and other metabolites. However, a serious problem was that both 2-hydroxybiphenyl and dioctyl phthalate were also detected in these krill tissues. Moreover, some intermediates of pesticides and medicinal or chemical compound products were found in krill tissue as well. This is the first survey to investigate the occurrence of chemical contamination in metabolites of Antarctic krill. These findings suggest that international contracts or policies should be developed to protect the pristine ocean.",
    "A strain TBE-6 capable of degrading triclopyr butoxyethyl ester (TBEE) was isolated from farmland soil. TBE-6 was identified as Lactobacillus buchneri based on 16S rRNA and analysis of morphology, physiological and biochemical characters. The optimal pH value and temperature were 6.5 and 37Z respectively. The strain TBE-6 had the ability to degrade TBEE, triclopyr and TCP. The degradation rate of TBEE (lOOmg/L) by the strain TBE-6 could reach 94.4% in 5d. The combined applications of the strain TBE-6 and the strain TR-13 was considered an effective means for rapidly degrading TBEE. The degradation rate of TBEE (l00mg/L) by the strain TBE-6 and the strain TR-13 could reach about 98.6% in 5d. In addition, the strain TBE-6 showed a high tolerance to TBEE. It was considered that the strain TBE-6 could be applied for bioremediation of TBEE, triclopyr or TCP pollution.",
    "The previous genesis potential index( GPI) can be applied to accurately simulate the climate distribution of tropical cyclone( TC) genesis,yet performs poorly in the simulation of interannual variation of TC genesis.The present study attempts to improve the GPI over the western North Pacific( WNP),by considering the important impact of relative vorticity on interannual variation of TC genesis.Based on the best-track data from the Joint Typhoon Warning Center and NCEP/NCAR reanalysis data from 1979 to 2011,we substitute the absolute vorticity in the previous GPI with a modified relative vorticity.The Coriolis factor remains intact.The difference of tropical cyclone formation between the South China Sea( SCS) and WNP is also considered,and the GPI for the SCS( 5°-25°N,100°-120°E) and WNP( 5°-40°N,120°-180°E) are respectively developed.The modified GPI is shown to improve the simulation of the climate distribution of TC genesis.Moreover,compared with the previous GPI,the modified GPI greatly improves the simulation of the interannual variation of TC genesis,in particular in regard to weak tropical cyclones.",
    "The author describes Phaneroptera abdita n. sp., characterized by only two apical spurs; two new species of Eulioptera, E. iolandae n. sp. with unarmed fore coxae, E. atypica n. sp., with atypical opaque tegmina; and Scolocerca thomasi n. sp., all from West Tropical Africa. In addition, he discusses on the probable only African distribution of Phaneroptera sparsa Stål, 1857, and transfers Dithela longicaudata Massa, 2017 to the genus Eulioptera Ragge, 1956.",
    "Tumor development is closely related to viral infections.The main known oncogenic viruses include HBV, HCV, HPV, HTLV-1, EBV, KSHV and MCPyV.The common viral related tumors include primary liver cancer, cervical cancer, head and neck malignant tumor, T-cell lymphoma, nasopharyngeal carcinoma and gastric cancer, Kaposi sarcoma, skin Merkel cell carcinoma, etc.Studies have shown that viral infection can promote the occurrence and development of malignant tumors by regulating signaling pathways, causing chronic inflammation, changing cell gene phenotype and destroying the genetic stability of host cells.In this review, we briefly summarize several known mechanisms of viral tumorigenesis, measures and ideas of reducing virus-related tumors.",
    "Accurate, reliable and efficient prediction of key variables reflecting the working behaviour of dams plays a vital role in safe construction and operation of dams. To predict and analyse the temperature field of a dam, this paper develops a parallel-over-series fusion model driven by both a mechanism model and a data model, and examines its feasibility by using the internal temperature of the Xiluodu arch dam. In series fusion, the camp chain method and the auxiliary technology of principal component analysis are adopted for back-calculating the thermal conductivities of dam concrete, by which optimised outputs of the mechanism model are obtained. In parallel fusion, the explanatory factor method and the linear-Gaussian model are used to construct a prediction model that enables the optimised mechanism model to be mapped to the dam temperature data. Experimental verification shows this fusion model, benefits from the explanatory power of the mechanism-driven model and the predictive advantage of the linear-Gaussian model. It can predict data fluctuations and has advantages in medium- and long-term forecasting. It reduces the overall prediction error by 81% compared with the series fusion model, while the latter reduces the error by 13% relative to the mechanism model.",
    "【Objective】This article aims to explore whether the forest park environment can relieve human tension,the differences in health benefits of different forest park environments and the impact of soundscape perception on the health benefits of forest park,and to further study on which soundscapes are important elements of restorative(positive benefits)soundscapes,in order to provide a basis for restorative soundscape design for forest park.【Method】Fuzhou national forest park was chosen for the study,20 videos(10 videos with voice and 10 without) on environment of the forest park were tested by 35 invited college students on the park campus.The Ergo LAB data platform was used for physiological data collection during the experiment.Soundscape perception questionnaire was used to evaluate soundscape perception of different samples.The median test was used to analyze the differences in health benefits of different forest park environments.Wilcoxon test was used to analyze the effects of forest park environment on stress recovery and the impact of soundscape perception on the health benefits of forest park.Moreover,optimal scale regression was used to determine the restorative soundscape elements.【Result 】Different forest park environments can effectively reduce the rare of skin conductance level(SCLr),heart rate(HR) and heart rate variability(LF/HF).But different forest park environmental health benefits were different.Green space sample plots S7,S9 and blue space sample plots S8,S10 health benefits were better.There were significant differences in SCLr among different forest park environments,but no significant differences in HR and LF/HF.The addition of soundscape can change health benefits of forest park environments.Except for the sample plots S5 where conversation and children's frolic sounds were more prominent,the health benefits of audiovisual combined stimuli were higher than single visual stimuli.Chirm,running water sound,cicadas chirp,and footsteps had a greater impact on SCLr.Chirm,running water sound,cicadas chirp and wind sound had a greater impact on LF/HF.Natural sounds such as chirm and running water sound had a greater contribution to the positive benefits(SCLr decreased,HR decreased,LF/HF decreased),while artificial sounds such as footsteps were the opposite.【Conclusion】The forest park environment can relieve stress to a certain extent.The health benefits of different forest park environments are different.Blue and green spaces play an important role in improving the health benefits.It is worth noting that the soundscape of forest parks is also the key to restorative environmental design.Natural sounds such as chirm and running water are important elements of restorative(positive benefit) soundscape.In the future,the design of restorative environment should start from multiple dimensions and fully explore a variety of restorative environmental elements,in order to provide more convincing evidences for the design of restorative environment of forest parks.",
    "We examine the comparative thermal evolution of Jupiter and Saturn, applying recent theoretical results for helium’s immiscibility in fluid metallic hydrogen. The redistribution of helium in their interiors proceeds very differently for the two planets. We confirm that, based on Jupiter’s atmospheric helium depletion as observed in situ by the <i>Galileo</i> entry probe, Jupiter’s interior helium has differentiated modestly, and we present models reconciling Jupiter’s helium depletion, radius, and heat flow at the solar age. Jupiter’s recently revised Bond albedo implies a higher intrinsic flux for the planet, accommodating more luminosity from helium differentiation, such that mildly superadiabatic interiors can satisfy all constraints. The same phase diagram applied to the less massive Saturn predicts dramatic helium differentiation, to the degree that Saturn inevitably forms a helium-rich shell or core, an outcome previously proposed by Stevenson &amp; Salpeter and others. The luminosity from Saturn’s helium differentiation is sufficient to extend its cooling time to the solar age, even for adiabatic interiors. This model predicts Saturn’s atmospheric helium to be depleted to <i>Y</i> = 0.07 ± 0.01, corresponding to a He/H<sub>2</sub> mixing ratio 0.036 ± 0.006. We also show that neon differentiation may have contributed to both planets’ luminosity in the past. These results demonstrate that Jupiter and Saturn’s thermal evolution can be explained self-consistently with a single physical model, and emphasize that nontrivial helium distributions should be considered in future models for Saturn’s internal structure and dynamo.",
    "82 single-lined hot subdwarf stars are identified by using spectra from the sixth and seventh data releases (DR6 and DR7) of the Large Sky Area Multi-Object Fibre Spectroscopic Telescope survey. We classified all the hot subdwarf stars using a canonical classification scheme, and got 89 sdB, 37 sdOB, 26 sdO, 24 He-sdOB, 3 He-sdO, and 3 He-sdB stars, respectively. Among these stars, 108 hot subdwarfs are newly discovered, while 74 stars were reported by previous catalogs. The atmospheric parameters of these stars were obtained by fitting the hydrogen (H) and helium (He) lines with non-local thermodynamic equilibrium model atmospheres. The atmospheric parameters confirm the two He sequences and the two subgroups of He-sdOB stars in our samples, which were found by previous studies in the <i>T</i> <sub>eff</sub>–\(\mathrm{log}(n\mathrm{He}/n{\rm{H}})\) diagram. Our results demonstrate different origins of field hot subdwarf stars and extreme horizontal branch stars in globular clusters, and provide strict observational limits on the formation and evolution models of the different sub-types of these evolved objects. Based on the results, we evaluated the completeness of the Geier et al. catalog. We found the fraction of hot subwarf stars is between 10% and 60%, depending on the brightness of the sample. A more accurate estimation for the hot subdwarf fraction can be obtained when similar results from composite spectra will become available.",
    "Streams are major sources of carbon dioxide (CO2) and methane (CH4) to the atmosphere, but current large-scale estimates are associated with high uncertainties because knowledge concerning the spatiotemporal control on stream emissions is limited. One of the largest uncertainties derives from the choice of gas transfer velocity (k600), which describes the physical efficiency of gas exchange across the water-atmosphere interface. This study therefore explored the variability in k600 and subsequent CO2 and CH4 emission rates within and across streams of different stream order (SO). We conducted, for the first time in streams, direct turbulence measurements using an acoustic Doppler velocimeter (ADV) to determine the spatial variability in k600 across a variety of scales with a consistent methodology. The results show high spatial variability in k600 and corresponding CO2 and CH4 emissions at small spatial scales, both within stream reaches and across SO, especially during high discharge. The k600 was positively related to current velocity and Reynolds number. By contrast, no clear relationship was found between k600 and specific stream characteristics such as width and depth, which are parameters often used in empirical models of k600. Improved understanding of the small-scale variability in the physical properties along streams, especially during high discharge, is therefore an important step to reduce the uncertainty in existing gas transfer models and emissions for stream systems. The ADV method was a useful tool for revealing spatial variability in this work, but it needs further development. We recommend that future studies conduct measurements over shorter time periods (e.g., 10-15 min instead of 40 min) and at more sites across the reach of interest, and thereby derive more reliable mean-reach k600 as well as more information about controls on the spatial variability in k600.",
    "Antarctic krill (Euphausia superba) is one of the most successful species on Earth and serves as the largest potential protein bank for both Antarctic animals and humans. Research on this species is of great value for exploitation of Antarctic biotic resources. In this study, the metabolomics of E. superba were investigated using the GC-MS method. A total of 293 compounds were initially identified; these compounds could be divided into several classes, including amino acids, sugars and polyols, metabolic intermediates, small molecules and other metabolites. However, a serious problem was that both 2-hydroxybiphenyl and dioctyl phthalate were also detected in these krill tissues. Moreover, some intermediates of pesticides and medicinal or chemical compound products were found in krill tissue as well. This is the first survey to investigate the occurrence of chemical contamination in metabolites of Antarctic krill. These findings suggest that international contracts or policies should be developed to protect the pristine ocean.",
    "A strain TBE-6 capable of degrading triclopyr butoxyethyl ester (TBEE) was isolated from farmland soil. TBE-6 was identified as Lactobacillus buchneri based on 16S rRNA and analysis of morphology, physiological and biochemical characters. The optimal pH value and temperature were 6.5 and 37Z respectively. The strain TBE-6 had the ability to degrade TBEE, triclopyr and TCP. The degradation rate of TBEE (lOOmg/L) by the strain TBE-6 could reach 94.4% in 5d. The combined applications of the strain TBE-6 and the strain TR-13 was considered an effective means for rapidly degrading TBEE. The degradation rate of TBEE (l00mg/L) by the strain TBE-6 and the strain TR-13 could reach about 98.6% in 5d. In addition, the strain TBE-6 showed a high tolerance to TBEE. It was considered that the strain TBE-6 could be applied for bioremediation of TBEE, triclopyr or TCP pollution.",
    "The previous genesis potential index( GPI) can be applied to accurately simulate the climate distribution of tropical cyclone( TC) genesis,yet performs poorly in the simulation of interannual variation of TC genesis.The present study attempts to improve the GPI over the western North Pacific( WNP),by considering the important impact of relative vorticity on interannual variation of TC genesis.Based on the best-track data from the Joint Typhoon Warning Center and NCEP/NCAR reanalysis data from 1979 to 2011,we substitute the absolute vorticity in the previous GPI with a modified relative vorticity.The Coriolis factor remains intact.The difference of tropical cyclone formation between the South China Sea( SCS) and WNP is also considered,and the GPI for the SCS( 5°-25°N,100°-120°E) and WNP( 5°-40°N,120°-180°E) are respectively developed.The modified GPI is shown to improve the simulation of the climate distribution of TC genesis.Moreover,compared with the previous GPI,the modified GPI greatly improves the simulation of the interannual variation of TC genesis,in particular in regard to weak tropical cyclones.",
    "The author describes Phaneroptera abdita n. sp., characterized by only two apical spurs; two new species of Eulioptera, E. iolandae n. sp. with unarmed fore coxae, E. atypica n. sp., with atypical opaque tegmina; and Scolocerca thomasi n. sp., all from West Tropical Africa. In addition, he discusses on the probable only African distribution of Phaneroptera sparsa Stål, 1857, and transfers Dithela longicaudata Massa, 2017 to the genus Eulioptera Ragge, 1956.",
    "Tumor development is closely related to viral infections.The main known oncogenic viruses include HBV, HCV, HPV, HTLV-1, EBV, KSHV and MCPyV.The common viral related tumors include primary liver cancer, cervical cancer, head and neck malignant tumor, T-cell lymphoma, nasopharyngeal carcinoma and gastric cancer, Kaposi sarcoma, skin Merkel cell carcinoma, etc.Studies have shown that viral infection can promote the occurrence and development of malignant tumors by regulating signaling pathways, causing chronic inflammation, changing cell gene phenotype and destroying the genetic stability of host cells.In this review, we briefly summarize several known mechanisms of viral tumorigenesis, measures and ideas of reducing virus-related tumors.",
    "Accurate, reliable and efficient prediction of key variables reflecting the working behaviour of dams plays a vital role in safe construction and operation of dams. To predict and analyse the temperature field of a dam, this paper develops a parallel-over-series fusion model driven by both a mechanism model and a data model, and examines its feasibility by using the internal temperature of the Xiluodu arch dam. In series fusion, the camp chain method and the auxiliary technology of principal component analysis are adopted for back-calculating the thermal conductivities of dam concrete, by which optimised outputs of the mechanism model are obtained. In parallel fusion, the explanatory factor method and the linear-Gaussian model are used to construct a prediction model that enables the optimised mechanism model to be mapped to the dam temperature data. Experimental verification shows this fusion model, benefits from the explanatory power of the mechanism-driven model and the predictive advantage of the linear-Gaussian model. It can predict data fluctuations and has advantages in medium- and long-term forecasting. It reduces the overall prediction error by 81% compared with the series fusion model, while the latter reduces the error by 13% relative to the mechanism model.",
    "【Objective】This article aims to explore whether the forest park environment can relieve human tension,the differences in health benefits of different forest park environments and the impact of soundscape perception on the health benefits of forest park,and to further study on which soundscapes are important elements of restorative(positive benefits)soundscapes,in order to provide a basis for restorative soundscape design for forest park.【Method】Fuzhou national forest park was chosen for the study,20 videos(10 videos with voice and 10 without) on environment of the forest park were tested by 35 invited college students on the park campus.The Ergo LAB data platform was used for physiological data collection during the experiment.Soundscape perception questionnaire was used to evaluate soundscape perception of different samples.The median test was used to analyze the differences in health benefits of different forest park environments.Wilcoxon test was used to analyze the effects of forest park environment on stress recovery and the impact of soundscape perception on the health benefits of forest park.Moreover,optimal scale regression was used to determine the restorative soundscape elements.【Result 】Different forest park environments can effectively reduce the rare of skin conductance level(SCLr),heart rate(HR) and heart rate variability(LF/HF).But different forest park environmental health benefits were different.Green space sample plots S7,S9 and blue space sample plots S8,S10 health benefits were better.There were significant differences in SCLr among different forest park environments,but no significant differences in HR and LF/HF.The addition of soundscape can change health benefits of forest park environments.Except for the sample plots S5 where conversation and children's frolic sounds were more prominent,the health benefits of audiovisual combined stimuli were higher than single visual stimuli.Chirm,running water sound,cicadas chirp,and footsteps had a greater impact on SCLr.Chirm,running water sound,cicadas chirp and wind sound had a greater impact on LF/HF.Natural sounds such as chirm and running water sound had a greater contribution to the positive benefits(SCLr decreased,HR decreased,LF/HF decreased),while artificial sounds such as footsteps were the opposite.【Conclusion】The forest park environment can relieve stress to a certain extent.The health benefits of different forest park environments are different.Blue and green spaces play an important role in improving the health benefits.It is worth noting that the soundscape of forest parks is also the key to restorative environmental design.Natural sounds such as chirm and running water are important elements of restorative(positive benefit) soundscape.In the future,the design of restorative environment should start from multiple dimensions and fully explore a variety of restorative environmental elements,in order to provide more convincing evidences for the design of restorative environment of forest parks.",
]

print(len(sentences))

tokenizer = AutoTokenizer.from_pretrained("sentence-transformers/all-MiniLM-L6-v2")
model = AutoModel.from_pretrained("sentence-transformers/all-MiniLM-L6-v2")

start = datetime.datetime.now()
encoded_input = tokenizer(sentences, padding=True, truncation=True, return_tensors="pt")

with torch.no_grad():
    model_output = model(**encoded_input)

sentence_embeddings = mean_pooling(model_output, encoded_input["attention_mask"])

sentence_embeddings = F.normalize(sentence_embeddings, p=2, dim=1)

print(datetime.datetime.now() - start)
print("Sentence embeddings:")
print(sentence_embeddings)
